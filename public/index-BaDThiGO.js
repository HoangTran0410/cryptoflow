const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./components/fileupload-Becg7XgT.js","./vendor-Blo1-9o0.js","./components/summarystats-DHw0oS-d.js","./components/chartssection-BWEpHkrp.js","./components/transactiontable-DaAzZqQz.js","./components/moneyflow-DAG8gX0k.js","./components/unifiedgraph-CzYImbfb.js","./components/forensicsdashboard-BoX6k6Au.js","./components/pathfinder-C_iyEiQA.js","./components/timelinetracer-ByyG7eGa.js","./components/taintchart-CEebpFbr.js","./components/loadingspinner-Bbytzj4b.js","./components/exportbutton-By9GotM5.js","./components/walletanalysis-BdgXi12k.js","./components/index-jq1RTpSS.js"])))=>i.map(i=>d[i]);
import{r as x,j as h,H as A,n as v,ar as D,as as O,v as P,ag as R,I as F,N as L,O as $,g as N,S as I,at as V,ad as z}from"./vendor-Blo1-9o0.js";import"./index-BaDThiGO.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&t(l)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();function ge(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}const U="modulepreload",W=function(n,s){return new URL(n,s).href},E={},b=function(s,e,t){let r=Promise.resolve();if(e&&e.length>0){let l=function(i){return Promise.all(i.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};const o=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));r=l(e.map(i=>{if(i=W(i,t),i in E)return;E[i]=!0;const u=i.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(!!t)for(let f=o.length-1;f>=0;f--){const w=o[f];if(w.href===i&&(!u||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${m}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":U,u||(p.as="script"),p.crossOrigin="",p.href=i,d&&p.setAttribute("nonce",d),document.head.appendChild(p),u)return new Promise((f,w)=>{p.addEventListener("load",f),p.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${i}`)))})}))}function a(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return r.then(l=>{for(const o of l||[])o.status==="rejected"&&a(o.reason);return s().catch(a)})},B=n=>{if(n.length===0)return{totalVolume:0,transactionCount:0,uniqueAddresses:0,avgTransactionValue:0,maxTransactionValue:0,startDate:new Date,endDate:new Date,topAddress:""};const s=n.reduce((o,c)=>o+c.amount,0),e=new Map;n.forEach(o=>{e.set(o.from,(e.get(o.from)||0)+o.amount),e.set(o.to,(e.get(o.to)||0)+o.amount)});let t="",r=0;e.forEach((o,c)=>{o>r&&(r=o,t=c)});const a=Math.max(...n.map(o=>o.amount)),l=n.map(o=>o.date.getTime());return{totalVolume:s,transactionCount:n.length,uniqueAddresses:e.size,avgTransactionValue:s/n.length,maxTransactionValue:a,startDate:new Date(Math.min(...l)),endDate:new Date(Math.max(...l)),topAddress:t}},q=n=>{const s=new Map;return n.forEach(e=>{const t=e.date.toISOString().split("T")[0],r=s.get(t)||{volume:0,count:0};s.set(t,{volume:r.volume+e.amount,count:r.count+1})}),Array.from(s.entries()).map(([e,t])=>({date:e,...t})).sort((e,t)=>e.date.localeCompare(t.date))},H=n=>{if(n.length===0)return 0;let s=0;const t=n.filter(o=>{const c=o.amount;return c>=1e3&&c%1e3===0}).length/n.length;s+=t*30;const r=[...n].sort((o,c)=>o.date.getTime()-c.date.getTime());let a=0;for(let o=1;o<r.length;o++)r[o].date.getTime()-r[o-1].date.getTime()<300*1e3&&a++;r.length>1&&(s+=a/(r.length-1)*30);const l=Math.min(n.length*3,20);if(s+=l,n.length>1){const o=n.map(m=>m.amount),c=o.reduce((m,g)=>m+g,0)/o.length,d=o.reduce((m,g)=>m+Math.pow(g-c,2),0)/o.length,i=Math.sqrt(d),u=c>0?i/c:1;u<.1?s+=20:u<.3&&(s+=10)}return Math.min(s,100)},K=(n,s,e,t=10,r=100)=>{const a=performance.now(),l=new Map;n.forEach(u=>{l.has(u.from)||l.set(u.from,[]),l.get(u.from).push({tx:u,to:u.to})});const o=[],c=(u,m,g,p,f)=>{if(o.length>=r||f>t)return;if(u===e){const T=p.reduce((_,M)=>_+M.amount,0),y=p.map(_=>_.date.getTime()).sort((_,M)=>_-M),j=y.slice(1).map((_,M)=>_-y[M]);o.push({addresses:[...g,u],transactions:[...p],totalAmount:T,hops:p.length,startDate:new Date(y[0]),endDate:new Date(y[y.length-1]),avgDelay:j.length>0?j.reduce((_,M)=>_+M,0)/j.length:0,suspicionScore:H(p)});return}const w=l.get(u)||[];for(const{tx:T,to:y}of w)m.has(y)||(m.add(y),c(y,m,[...g,u],[...p,T],f+1),m.delete(y))};c(s,new Set([s]),[],[],0);const i=o.length>0?o.reduce((u,m)=>m.hops<u.hops?m:u,o[0]):null;return{source:s,target:e,paths:o,shortestPath:i,statistics:{totalPathsFound:o.length,avgPathLength:o.length>0?o.reduce((u,m)=>u+m.hops,0)/o.length:0,executionTime:performance.now()-a}}},we=(n,s,e,t=10)=>{const r=K(n,s,e,t,1e3),a=[];let l=0;r.paths.forEach(i=>{if(i.transactions.length===0)return;let u=i.transactions[0].amount;for(let m=0;m<i.transactions.length;m++){const g=i.transactions[m],p=g.from,w=n.filter(T=>T.from===p&&T.date>=g.date&&T.date<=new Date(g.date.getTime()+1440*60*1e3)).reduce((T,y)=>T+y.amount,0);w>0&&(u*=g.amount/w)}u>.01&&(a.push({path:i.addresses,amount:u,percentage:u/i.transactions[0].amount*100}),l+=u)});const c=n.filter(i=>i.to===e).reduce((i,u)=>i+u.amount,0),d=c>0?l/c*100:0;return{sourceAddress:s,targetAddress:e,totalTainted:l,taintPercentage:d,paths:a.sort((i,u)=>u.amount-i.amount).slice(0,20),hops:t}},xe=(n,s)=>{const e=[],t=n.filter(o=>o.from===s||o.to===s).sort((o,c)=>o.date.getTime()-c.date.getTime());if(t.length===0)return e;const r=new Map;t.forEach(o=>{const c=o.date.toISOString().split("T")[0];r.has(c)||r.set(c,[]),r.get(c).push(o)}),r.forEach((o,c)=>{const d=o.reduce((p,f)=>p+f.amount,0);let i="transfer",u=.5;o.length>10&&(i="spike",u=Math.min(o.length/50,1));const m=o.filter(p=>p.to===s),g=o.filter(p=>p.from===s);m.length>5&&g.length<=1?(i="aggregation",u=.8):m.length<=1&&g.length>5&&(i="split",u=.8),e.push({timestamp:new Date(c),type:i,address:s,amount:d,relatedAddresses:Array.from(new Set(o.map(p=>p.from===s?p.to:p.from))),significance:u})});const a=e.sort((o,c)=>o.timestamp.getTime()-c.timestamp.getTime()),l=[];for(let o=1;o<a.length;o++){const c=a[o].timestamp.getTime()-a[o-1].timestamp.getTime(),d=c/(1e3*60*60*24);d>7&&l.push({timestamp:new Date(a[o-1].timestamp.getTime()+c/2),type:"dormant",address:s,amount:0,relatedAddresses:[],significance:Math.min(d/30,1)})}return[...e,...l].sort((o,c)=>o.timestamp.getTime()-c.timestamp.getTime())},ye=n=>{const s=new Set;return n.forEach(e=>{s.add(e.from),s.add(e.to)}),Array.from(s).sort()},ve=(n,s)=>{const e=n.filter(f=>f.to===s),t=n.filter(f=>f.from===s),r=[...e,...t].sort((f,w)=>f.date.getTime()-w.date.getTime()),a=e.reduce((f,w)=>f+w.amount,0),l=t.reduce((f,w)=>f+w.amount,0),o=new Map;e.forEach(f=>{const w=o.get(f.from)||{volume:0,count:0};o.set(f.from,{volume:w.volume+f.amount,count:w.count+1})}),t.forEach(f=>{const w=o.get(f.to)||{volume:0,count:0};o.set(f.to,{volume:w.volume+f.amount,count:w.count+1})});const c=Array.from(o.entries()).map(([f,w])=>({address:f,volume:w.volume,count:w.count})).sort((f,w)=>w.volume-f.volume).slice(0,10),d=new Map;r.forEach(f=>{const w=f.date.getHours();d.set(w,(d.get(w)||0)+1)});let i=0,u=0;d.forEach((f,w)=>{f>u&&(u=f,i=w)});const m=r.length,g=a+l,p=Math.min(100,m*2+Math.log10(g+1)*10);return{address:s,totalInflow:a,totalOutflow:l,netBalance:a-l,inflowCount:e.length,outflowCount:t.length,totalTxCount:m,avgInflowSize:e.length>0?a/e.length:0,avgOutflowSize:t.length>0?l/t.length:0,firstTxDate:r.length>0?r[0].date:new Date,lastTxDate:r.length>0?r[r.length-1].date:new Date,topCounterparties:c,peakActivityHour:i,activityScore:p}},be=(n,s,e="daily")=>{const t=new Map,r=a=>{if(e==="daily")return a.toISOString().split("T")[0];if(e==="weekly"){const l=new Date(a),o=l.getDay(),c=l.getDate()-o;return new Date(l.setDate(c)).toISOString().split("T")[0]}else return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`};return n.forEach(a=>{const l=r(a.date),o=t.get(l)||{inflow:0,outflow:0,inflowCount:0,outflowCount:0};a.to===s?(o.inflow+=a.amount,o.inflowCount+=1):a.from===s&&(o.outflow+=a.amount,o.outflowCount+=1),t.set(l,o)}),Array.from(t.entries()).map(([a,l])=>({date:a,inflow:l.inflow,outflow:l.outflow,netFlow:l.inflow-l.outflow,inflowCount:l.inflowCount,outflowCount:l.outflowCount})).sort((a,l)=>a.date.localeCompare(l.date))},G=()=>{const n=x.useCallback(async s=>{var a;const e=s.target,t=(a=e==null?void 0:e.closest)==null?void 0:a.call(e,".copyable");if(!t)return;const r=t.dataset.copy;if(r)try{await navigator.clipboard.writeText(r),t.classList.add("copied"),setTimeout(()=>{t.classList.remove("copied")},1500)}catch(l){console.error("Failed to copy:",l)}},[]);x.useEffect(()=>(document.addEventListener("click",n),()=>{document.removeEventListener("click",n)}),[n])},S=h.jsx("div",{className:"flex items-center justify-center w-full h-full min-h-[100px]",children:h.jsx(A,{className:"w-6 h-6 text-white/50 animate-spin"})}),J=v(()=>b(()=>import("./components/fileupload-Becg7XgT.js"),__vite__mapDeps([0,1]),import.meta.url),{fallback:S}),Y=v(()=>b(()=>import("./components/summarystats-DHw0oS-d.js"),__vite__mapDeps([2,1]),import.meta.url),{fallback:S}),X=v(()=>b(()=>import("./components/chartssection-BWEpHkrp.js"),__vite__mapDeps([3,1]),import.meta.url),{fallback:S}),Q=v(()=>b(()=>import("./components/transactiontable-DaAzZqQz.js"),__vite__mapDeps([4,1]),import.meta.url),{fallback:S}),Z=v(()=>b(()=>import("./components/moneyflow-DAG8gX0k.js"),__vite__mapDeps([5,1]),import.meta.url),{fallback:S}),ee=v(()=>b(()=>import("./components/unifiedgraph-CzYImbfb.js"),__vite__mapDeps([6,1,4]),import.meta.url),{fallback:S}),te=v(()=>b(()=>import("./components/forensicsdashboard-BoX6k6Au.js"),__vite__mapDeps([7,1]),import.meta.url),{fallback:S}),oe=v(()=>b(()=>import("./components/pathfinder-C_iyEiQA.js"),__vite__mapDeps([8,1]),import.meta.url),{fallback:S}),ne=v(()=>b(()=>import("./components/timelinetracer-ByyG7eGa.js"),__vite__mapDeps([9,1]),import.meta.url),{fallback:S});v(()=>b(()=>import("./components/taintchart-CEebpFbr.js"),__vite__mapDeps([10,1,11,12]),import.meta.url),{fallback:S});const se=v(()=>b(()=>import("./components/walletanalysis-BdgXi12k.js"),__vite__mapDeps([13,1]),import.meta.url),{fallback:S}),re=v(()=>b(()=>import("./components/index-jq1RTpSS.js"),__vite__mapDeps([14,1]),import.meta.url),{fallback:S}),ae=()=>{G();const[n,s]=x.useState([]),[e,t]=x.useState("overview"),[r,a]=x.useState(new Set(["overview"])),l=i=>{s(i),t("overview"),a(new Set(["overview"]))};x.useEffect(()=>{n.length>0&&a(i=>{const u=new Set(i);return u.add(e),u})},[e,n]);const o=x.useMemo(()=>B(n),[n]),c=x.useMemo(()=>q(n),[n]),d=[{id:"overview",label:"Dashboard",icon:O},{id:"arkham",label:"Arkham Tracer",icon:P},{id:"money-flow",label:"Money Flow Analysis",icon:D},{id:"transactions",label:"Transactions",icon:R},{id:"wallet-analysis",label:"Wallet Analysis",icon:F},{id:"interactive",label:"Interactive Graph",icon:L},{id:"path-finder",label:"Path Finder",icon:$},{id:"timeline",label:"Timeline Tracer",icon:N},{id:"forensics",label:"Forensics Suite",icon:I}];return h.jsxs("div",{className:"min-h-screen bg-slate-950 text-slate-100 font-sans flex flex-col",children:[h.jsxs("header",{className:"border-b border-slate-800 bg-slate-950/80 backdrop-blur",children:[h.jsxs("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-lg flex items-center justify-center shadow-lg shadow-indigo-500/20",children:h.jsx(D,{className:"w-5 h-5 text-white"})}),h.jsx("span",{className:"text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-slate-400",children:"CryptoFlow"})]}),n.length>0&&h.jsx("button",{onClick:()=>s([]),className:"text-xs font-medium text-slate-400 hover:text-white transition-colors border border-slate-800 px-3 py-1.5 rounded bg-slate-900",children:"Reset Data"})]}),n.length>0&&h.jsx("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 mt-2 overflow-x-auto",children:h.jsx("nav",{className:"flex space-x-1 border-b border-slate-800/50 pb-0","aria-label":"Tabs",children:d.map(i=>{const u=e===i.id;return h.jsxs("button",{onClick:()=>t(i.id),className:`
                      flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap
                      ${u?"border-indigo-500 text-indigo-400":"border-transparent text-slate-400 hover:text-slate-200 hover:border-slate-700"}
                    `,children:[h.jsx(i.icon,{className:`w-4 h-4 ${u?"text-indigo-400":"text-slate-500"}`}),i.label]},i.id)})})})]}),h.jsx("main",{className:`flex-1 max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 w-full ${e==="interactive"?"py-4":"py-8"}`,children:n.length===0?h.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[80vh]",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 via-purple-400 to-emerald-400",children:"Visualize Money Flow"}),h.jsx("p",{className:"text-slate-400 max-w-lg mx-auto text-lg",children:"Upload your transaction ledger to instantly generate interactive flow graphs, volume analytics, and wallet statistics."})]}),h.jsx(J,{onDataLoaded:l})]}):h.jsxs("div",{className:"animate-fade-in h-full relative",children:[h.jsx("div",{style:{display:e==="overview"?"block":"none"},children:h.jsxs("div",{className:"space-y-8",children:[h.jsx(Y,{summary:o}),h.jsx(X,{dailyData:c})]})}),h.jsx("div",{style:{display:e==="interactive"?"block":"none"},className:"h-full",children:r.has("interactive")&&h.jsx(ee,{transactions:n,initialAddress:o.topAddress})}),h.jsx("div",{style:{display:e==="money-flow"?"block":"none"},className:"h-full",children:r.has("money-flow")&&h.jsx(Z,{transactions:n})}),h.jsx("div",{style:{display:e==="forensics"?"block":"none"},className:"h-full",children:r.has("forensics")&&h.jsx(te,{transactions:n})}),h.jsx("div",{style:{display:e==="path-finder"?"block":"none"},className:"h-full",children:r.has("path-finder")&&h.jsx(oe,{transactions:n})}),h.jsx("div",{style:{display:e==="timeline"?"block":"none"},className:"h-full",children:r.has("timeline")&&h.jsx(ne,{transactions:n})}),h.jsx("div",{style:{display:e==="wallet-analysis"?"block":"none"},className:"h-full",children:r.has("wallet-analysis")&&h.jsx(se,{transactions:n})}),h.jsx("div",{style:{display:e==="transactions"?"block":"none"},className:"h-full",children:r.has("transactions")&&h.jsx(Q,{transactions:n})}),h.jsx("div",{style:{display:e==="arkham"?"block":"none"},className:"h-full",children:r.has("arkham")&&h.jsx(re,{transactions:n})})]})}),h.jsx("footer",{className:"border-t border-slate-900 mt-auto py-8 text-center",children:h.jsx("p",{className:"text-slate-600 text-sm",children:"CryptoFlow Analytics • Local processing only"})})]})},k=document.getElementById("root");if(!k)throw new Error("Could not find root element to mount to");const ie=V.createRoot(k);ie.render(h.jsx(z.StrictMode,{children:h.jsx(ae,{})}));const Se=(()=>{const n=[],s=new Date,e=["Binance_Hot_Wallet","Coinbase_Prime","OKX_Reserves","Kraken_Deposit","Huobi_Global"],t=["Uniswap_V3_USDT_ETH","Curve_3pool","Aave_Lending_Pool","Stargate_Bridge_USDT"],r=["Wintermute_Trading","Jump_Crypto","GSR_Markets"],a="Tornado_Cash_Router",l=Array.from({length:20},(d,i)=>`0xWhale_${i.toString().padStart(2,"0")}`),o=Array.from({length:1e3},(d,i)=>`0x${Math.floor(Math.random()*1e5).toString(16).padStart(4,"0")}`),c=(d,i,u,m)=>{const g=new Date(s);g.setHours(g.getHours()-m),g.setMinutes(g.getMinutes()+Math.floor(Math.random()*60)),n.push({id:`tx_${Math.random().toString(36).substr(2,9)}`,date:g,from:d,to:i,amount:parseFloat(u.toFixed(2)),currency:"USDT",type:"transfer"})};for(let d=0;d<2e3;d++){const i=e[Math.floor(Math.random()*e.length)],u=o[Math.floor(Math.random()*o.length)],m=Math.random()>.4,g=Math.random()*5e3+100,p=Math.floor(Math.random()*24*90);m?c(u,i,g,p):c(i,u,g*.9,p)}for(let d=0;d<200;d++){const i=l[Math.floor(Math.random()*l.length)],u=e[Math.floor(Math.random()*e.length)],m=Math.random()*5e5+5e4,g=Math.floor(Math.random()*24*90);Math.random()>.5?c(i,u,m,g):c(u,i,m,g)}for(let d=0;d<100;d++){const i=r[Math.floor(Math.random()*r.length)],u=e[Math.floor(Math.random()*e.length)],m=t[Math.floor(Math.random()*t.length)],g=Math.random()*1e5+1e4,p=Math.floor(Math.random()*24*30);c(i,u,g,p+4),c(u,m,g*.99,p+3),c(m,i,g*1.01,p+2)}for(let d=0;d<50;d++){const i=o[Math.floor(Math.random()*100)],u=`0xMule_${Math.random().toString(16).substr(2,4)}`,m=`0xMule_${Math.random().toString(16).substr(2,4)}`,g=e[0],p=2e4,f=Math.floor(Math.random()*24*10);c(i,u,p,f+5),c(u,m,p*.98,f+4),c(m,a,p*.96,f+3),c(a,g,p*.9,f+1)}for(let d=0;d<300;d++){const i=o[Math.floor(Math.random()*o.length)],u="Stargate_Bridge_USDT",m=Math.random()*2e3,g=Math.floor(Math.random()*24*60);c(i,u,m,g)}return n.sort((d,i)=>i.date.getTime()-d.date.getTime())})(),Te=(n,s=6,e=4)=>n.length<=s+e?n:`${n.slice(0,s)}...${n.slice(-e)}`,_e=n=>n>=1e6?`$${(n/1e6).toFixed(1)}M`:n>=1e3?`$${(n/1e3).toFixed(1)}K`:`$${n.toFixed(0)}`,Me=n=>{const e=new Date().getTime()-n.getTime(),t=Math.floor(e/1e3),r=Math.floor(t/60),a=Math.floor(r/60),l=Math.floor(a/24),o=Math.floor(l/7),c=Math.floor(l/30),d=Math.floor(l/365);return d>0?`${d}y ago`:c>0?`${c}mo ago`:o>0?`${o}w ago`:l>0?`${l}d ago`:a>0?`${a}h ago`:r>0?`${r}m ago`:"just now"},je=()=>{const[n,s]=x.useState(!1),e=x.useRef(null),t=x.useRef(new Map);return x.useEffect(()=>{try{e.current=new Worker(new URL(""+new URL("forensics.worker-CDTmhihb.js",import.meta.url).href,import.meta.url),{type:"module"}),s(!0),e.current.onmessage=a=>{const{type:l,requestId:o,data:c,error:d}=a.data,i=t.current.get(o);i&&(l==="SUCCESS"?i(c):l==="ERROR"&&(console.error("Forensics Worker error:",d),i(null)),t.current.delete(o))},e.current.onerror=a=>{console.error("Worker error:",a)}}catch(a){console.error("Failed to initialize forensics worker:",a)}return()=>{var a;(a=e.current)==null||a.terminate(),t.current.clear()}},[]),{executeTask:x.useCallback(a=>new Promise(l=>{if(!e.current){console.warn("Worker not initialized, returning null"),l(null);return}const o=`req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;t.current.set(o,l);const c={...a,requestId:o};e.current.postMessage(c)}),[]),isReady:n}};class C{constructor(s=50,e=30){this.cache=new Map,this.currentSize=0,this.maxSize=s*1024*1024,this.ttl=e*60*1e3}set(s,e){const t=JSON.stringify(e).length*2;for(;this.currentSize+t>this.maxSize&&this.cache.size>0;)this.evictOldest();const r=this.cache.get(s);r&&(this.currentSize-=r.size),this.cache.set(s,{data:e,timestamp:Date.now(),size:t}),this.currentSize+=t}get(s){const e=this.cache.get(s);return e?Date.now()-e.timestamp>this.ttl?(this.delete(s),null):e.data:null}delete(s){const e=this.cache.get(s);e&&(this.currentSize-=e.size,this.cache.delete(s))}evictOldest(){let s=null,e=1/0;this.cache.forEach((t,r)=>{t.timestamp<e&&(e=t.timestamp,s=r)}),s&&this.delete(s)}clear(){this.cache.clear(),this.currentSize=0}stats(){return{entries:this.cache.size,sizeMB:(this.currentSize/(1024*1024)).toFixed(2),maxSizeMB:(this.maxSize/(1024*1024)).toFixed(2),utilization:(this.currentSize/this.maxSize*100).toFixed(1)+"%"}}has(s){return this.cache.has(s)&&this.get(s)!==null}}const De=new C(20,30),Ee=new C(10,30),ke=(n,s)=>{const e=Object.keys(s).sort().map(t=>`${t}:${JSON.stringify(s[t])}`).join("|");return`${n}_${e}`},le=n=>{const s=["Path","Hops","Total Amount","Suspicion Score","Start Date","End Date","Avg Delay (hours)"],e=n.map(t=>[t.addresses.join(" → "),t.hops.toString(),t.totalAmount.toFixed(2),t.suspicionScore.toFixed(1),t.startDate.toISOString(),t.endDate.toISOString(),(t.avgDelay/36e5).toFixed(2)]);return[s.join(","),...e.map(t=>t.map(r=>`"${r}"`).join(","))].join(`
`)},ce=n=>JSON.stringify({generatedAt:new Date().toISOString(),version:"1.0",application:"CryptoFlow Analytics",...n},null,2),ue=n=>{const s=["Type","Severity","Score","Description","Affected Addresses Count","Transactions Count"],e=n.map(t=>[t.type,t.severity,t.score.toString(),t.description,t.affectedAddresses.length.toString(),t.transactions.length.toString()]);return[s.join(","),...e.map(t=>t.map(r=>`"${r}"`).join(","))].join(`
`)},me=n=>{const s=["Source","Target","Total Tainted","Taint Percentage","Path","Path Amount","Path Percentage"],e=n.paths.map(t=>[n.sourceAddress,n.targetAddress,n.totalTainted.toFixed(2),n.taintPercentage.toFixed(2),t.path.join(" → "),t.amount.toFixed(2),t.percentage.toFixed(2)]);return[s.join(","),...e.map(t=>t.map(r=>`"${r}"`).join(","))].join(`
`)},de=n=>{const s=["Cluster ID","Address Count","Common Behavior","Total Volume","Transaction Count","Confidence Score"],e=n.map(t=>[t.clusterId,t.addresses.length.toString(),t.commonBehavior,t.totalVolume.toFixed(2),t.transactionCount.toString(),t.confidenceScore.toFixed(2)]);return[s.join(","),...e.map(t=>t.map(r=>`"${r}"`).join(","))].join(`
`)},he=(n,s)=>{const e=URL.createObjectURL(n),t=document.createElement("a");t.href=e,t.download=s,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(e)},Ce=(n,s,e)=>{let t,r,a;switch(s){case"paths":t=le(n),r="csv",a="text/csv";break;case"patterns":t=ue(n),r="csv",a="text/csv";break;case"taint":t=me(n),r="csv",a="text/csv";break;case"clusters":t=de(n),r="csv",a="text/csv";break;case"json":default:t=ce(n),r="json",a="application/json";break}const l=new Blob([t],{type:`${a};charset=utf-8`}),o=`cryptoflow-${s}-${new Date().toISOString().split("T")[0]}.${r}`;he(l,e||o)};export{S as L,Se as S,b as _,Te as a,De as b,me as c,xe as d,Ce as e,_e as f,ke as g,ye as h,ve as i,be as j,we as k,Me as l,ge as m,Ee as p,je as u};
