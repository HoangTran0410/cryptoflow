import{r as C,j as u}from"../vendor-Cs9IRPBE.js";import{f as W}from"../index-KZY9J4_4.js";const F=100,J=500,K=1e3,tt=({connections:a,walletPositions:l,transform:e,connectionStyle:d,selectedConnection:o,onConnectionClick:y})=>{const T=C.useCallback((t,s,r,A)=>{if(typeof window>"u")return!0;const i=window.innerWidth,n=window.innerHeight,h=t*e.k+e.x,c=s*e.k+e.y,x=r*e.k+e.x,$=A*e.k+e.y,p=100,f=Math.min(h,x),M=Math.max(h,x),k=Math.min(c,$),N=Math.max(c,$);return!(M<-p||f>i+p||N<-p||k>n+p)},[e]),g=C.useMemo(()=>{const t=new Map;return a.forEach(s=>{const[r,A]=s.fromAddress<s.toAddress?[s.fromAddress,s.toAddress]:[s.toAddress,s.fromAddress],i=`${r}<->${A}`,n=t.get(i)||{addressA:r,addressB:A,aToB:null,bToA:null,totalAmount:0};s.fromAddress===r?n.aToB=s:n.bToA=s,n.totalAmount+=s.totalAmount,t.set(i,n)}),Array.from(t.values())},[a]),j=Math.max(...g.map(t=>t.totalAmount),1),w=!!o,H=Q(g.length);return u.jsx("g",{className:"connections-group",children:g.map(t=>{var _,v;const s=l.get(t.addressA),r=l.get(t.addressB);if(!s||!r)return null;const A=Math.abs(s.x-r.x)<1;let i,n,h,c,x;if(A?(i=s.y<r.y?s.x:r.x,n=s.y<r.y?s.y:r.y,h=s.y<r.y?r.x:s.x,c=s.y<r.y?r.y:s.y,x=s.y<r.y,t.addressA,t.addressB):(x=s.x<=r.x,i=x?s.rightEdge:s.leftEdge,n=s.y,h=x?r.leftEdge:r.rightEdge,c=r.y,x?t.addressA:t.addressB,x?t.addressB:t.addressA),!T(i,n,h,c))return null;const $=A?S(i,n,h,c):I(d,i,n,h,c),p=A?S(h,c,i,n):I(d,h,c,i,n);let f=null;t.aToB&&!t.bToA?(t.aToB,t.aToB.fromAddress===t.addressA?f=$:f=p):t.bToA&&!t.aToB&&(t.bToA,t.bToA.fromAddress===t.addressA?f=$:f=p);const M=Math.max(2,Math.min(8,t.totalAmount/j*8)),k=t.aToB!==null,N=t.bToA!==null,O=k&&N,B="#10b981",m="#a855f7",D="#55ee44";if(!(t.aToB||t.bToA))return null;const z=(i+h)/2,G=(n+c)/2-10,V=`${t.addressA}<->${t.addressB}`,P=Math.sqrt(Math.pow(h-i,2)+Math.pow(c-n,2))*1.5,R=o&&(o.from===t.addressA&&o.to===t.addressB||o.from===t.addressB&&o.to===t.addressA),q=w?R?1:.3:.6;return u.jsxs("g",{className:"connection",style:{cursor:y?"pointer":"default"},onClick:E=>{E.stopPropagation(),y==null||y(t)},children:[u.jsx("path",{d:$,fill:"none",stroke:O?m:B,strokeWidth:R?M+2:M,strokeLinecap:"round",strokeOpacity:q}),f&&H.enabled&&u.jsx("g",{children:Array.from({length:H.count},(E,L)=>L/H.count).map((E,L)=>u.jsx("circle",{r:3,fill:D,opacity:1,children:u.jsx("animateMotion",{dur:`${2+P/200}s`,repeatCount:"indefinite",begin:`${E*(2+P/200)}s`,path:f})},`particle-${L}`))}),e.k>.5&&u.jsxs("g",{transform:`translate(${z}, ${G})`,children:[u.jsx("rect",{x:-45,y:-9,width:90,height:18,rx:4,fill:"rgba(15, 23, 42, 0.95)",stroke:O?m:B,strokeWidth:1}),O?u.jsxs("text",{x:0,y:4,textAnchor:"middle",fill:"#e2e8f0",fontSize:9,fontWeight:500,children:[u.jsx("tspan",{fill:B,children:W(((_=t.aToB)==null?void 0:_.totalAmount)||0)}),u.jsx("tspan",{fill:"#64748b",children:" / "}),u.jsx("tspan",{fill:B,children:W(((v=t.bToA)==null?void 0:v.totalAmount)||0)})]}):u.jsx("text",{x:0,y:4,textAnchor:"middle",fill:"#e2e8f0",fontSize:10,fontWeight:500,children:W(t.totalAmount)})]})]},V)})})},I=(a,l,e,d,o)=>{switch(a){case"straight":return S(l,e,d,o);case"step":return Y(l,e,d,o);case"curve":default:return U(l,e,d,o)}},Q=a=>a>K?{enabled:!1,count:0}:a>J?{enabled:!0,count:1}:a>F?{enabled:!0,count:2}:{enabled:!0,count:2},U=(a,l,e,d)=>{const o=e-a,y=Math.abs(o),T=Math.min(y*.5,150),g=o>=0?1:-1,j=a+T*g,w=e-T*g;return`M ${a} ${l} C ${j} ${l}, ${w} ${d}, ${e} ${d}`},S=(a,l,e,d)=>`M ${a} ${l} L ${e} ${d}`,Y=(a,l,e,d)=>{const o=(a+e)/2;return`M ${a} ${l} L ${o} ${l} L ${o} ${d} L ${e} ${d}`};export{tt as default};
