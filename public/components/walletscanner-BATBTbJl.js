import{r as t,j as e,ar as W,as as z,U as he,m as G,S as me,H as X,at as ue,au as ge,av as pe,J as $,f as L,D as be,aw as fe,E as B,p as je}from"../vendor-DWEmHMvc.js";import{m as Ne,n as we,s as ye,o as ve,q as Ce,C as H,r as Se,t as S,v as ke,w as Ae}from"../index-CodYiM9M.js";const V="cryptoflow_etherscan_api_key",Ie=({onDataLoaded:F})=>{const[h,Y]=t.useState("bsc"),[M,k]=t.useState(""),[m,R]=t.useState("single-layer"),[A,J]=t.useState(2),[n,Q]=t.useState(()=>typeof window<"u"&&localStorage.getItem(V)||"");t.useEffect(()=>{n&&localStorage.setItem(V,n)},[n]);const[Z,U]=t.useState(!1),[u,g]=t.useState(!1),[f,D]=t.useState([]),[j,_]=t.useState(null),[i,K]=t.useState([]),[q,N]=t.useState(null),r=t.useRef(null),[P,ee]=t.useState(!0),[T,se]=t.useState(!0),[w,te]=t.useState(!1),[x,ae]=t.useState(!0),[c,y]=t.useState(null),[I,O]=t.useState(""),l=Ne(M),le=s=>{var v;const a=(v=s.target.files)==null?void 0:v[0];if(!a)return;const p=new FileReader;p.onload=d=>{var b;const o=(b=d.target)==null?void 0:b.result;k(o)},p.readAsText(a)},re=t.useCallback(async()=>{if(!n.trim()){N("Moralis API key required. Get a free key at https://admin.moralis.com/web3apis");return}if(l.length===0){N("Please enter at least one valid address");return}const s=new we;r.current=s,U(!0),g(!1),N(null),D([]),_(null),K([]);try{let a;const p=d=>{D(o=>{const b=o.findIndex(C=>C.address===d.address);if(b>=0){const C=[...o];return C[b]=d,C}return[...o,d]})};m==="multi-layer"?a=await ye(l,n,{chain:h,usdtOnly:!0,useCache:x,controller:s,maxLayers:A,onProgress:p,onLayerComplete:(d,o)=>{console.log(`Layer ${d} complete:`,o.length,"addresses")}}):a=await ve(l,n,{chain:h,usdtOnly:!0,useCache:x,controller:s,onProgress:p}),_(a);const v=Ce(a.allTransactions,l);K(v),a.allTransactions.length>0&&F(a.allTransactions)}catch(a){N(a.message)}finally{U(!1),g(!1),r.current=null}},[n,l,h,m,A,x,F]),ne=t.useCallback(()=>{r.current&&!r.current.isPaused&&(r.current.pause(),g(!0))},[]),ce=t.useCallback(()=>{r.current&&r.current.isPaused&&(r.current.resume(),g(!1))},[]),ie=t.useCallback(()=>{r.current&&(r.current.stop(),g(!1))},[]),de=s=>s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(2),E=f.filter(s=>s.status==="success").length,oe=f.filter(s=>s.status==="error").length,xe=l.length>0?E/l.length*100:0;return e.jsxs("div",{className:"w-full max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"ðŸ” Wallet Scanner"}),e.jsx("p",{className:"text-slate-400",children:"Scan wallet addresses to fetch USDT transactions and trace fund flows"})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Moralis API Key",e.jsxs("a",{href:"https://admin.moralis.com/web3apis",target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-indigo-400 hover:text-indigo-300 inline-flex items-center gap-1",children:["Get free key ",e.jsx(W,{className:"w-3 h-3"})]})]}),e.jsx("input",{type:"password",value:n,onChange:s=>Q(s.target.value),placeholder:"Enter your Moralis API key",className:"w-full px-4 py-3 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none"}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"ðŸ”‘ Free tier: 40K requests/month. Sign up at moralis.com for free API key."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-slate-700",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Blockchain"}),e.jsx("select",{value:h,onChange:s=>Y(s.target.value),className:"w-full px-4 py-2.5 bg-slate-900 border border-slate-700 rounded-lg text-white focus:border-indigo-500 outline-none",children:Object.entries(H).map(([s,a])=>e.jsxs("option",{value:s,children:[a.name," (",a.symbol,")"]},s))})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-slate-700",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Scan Mode"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>R("single-layer"),className:`flex-1 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors ${m==="single-layer"?"bg-indigo-600 text-white":"bg-slate-900 text-slate-400 hover:bg-slate-800"}`,children:"Single Layer (F1)"}),e.jsx("button",{onClick:()=>R("multi-layer"),className:`flex-1 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors ${m==="multi-layer"?"bg-indigo-600 text-white":"bg-slate-900 text-slate-400 hover:bg-slate-800"}`,children:"Multi Layer (F1â†’F2â†’...)"})]}),m==="multi-layer"&&e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsx("label",{className:"text-sm text-slate-400",children:"Max layers:"}),e.jsx("input",{type:"number",min:2,max:5,value:A,onChange:s=>J(parseInt(s.target.value)||2),className:"w-20 px-3 py-1.5 bg-slate-900 border border-slate-700 rounded-lg text-white text-center"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300",children:["Wallet Addresses (",l.length," valid)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{const s=l.join(`
`);k(s)},className:"px-3 py-1.5 bg-emerald-600 hover:bg-emerald-500 text-white text-sm rounded-lg flex items-center gap-2 transition-colors",title:"Parse and remove duplicates",children:[e.jsx(z,{className:"w-4 h-4"}),"Clean (",l.length,")"]}),e.jsxs("label",{className:"cursor-pointer px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-slate-300 text-sm rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx(he,{className:"w-4 h-4"}),"Upload TXT",e.jsx("input",{type:"file",accept:".txt,.csv",onChange:le,className:"hidden"})]})]})]}),e.jsx("textarea",{value:M,onChange:s=>k(s.target.value),placeholder:`Paste wallet addresses here (one per line)
0x1234...
0x5678...
0xabcd...`,rows:8,className:"w-full px-4 py-3 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 outline-none font-mono text-sm resize-y"})]}),q&&e.jsxs("div",{className:"p-4 bg-red-900/30 border border-red-800/50 rounded-xl flex items-center gap-3 text-red-200",children:[e.jsx(G,{className:"w-5 h-5 shrink-0"}),e.jsx("span",{children:q})]}),e.jsx("div",{className:"flex gap-3",children:Z?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 py-4 rounded-xl bg-slate-700 text-white font-semibold text-lg flex items-center justify-center gap-3",children:[e.jsx(X,{className:`w-5 h-5 ${u?"":"animate-spin"}`}),u?"Paused":"Scanning..."," (",E,"/",l.length,")"]}),e.jsx("button",{onClick:u?ce:ne,className:`px-6 py-4 rounded-xl font-semibold flex items-center gap-2 transition-all ${u?"bg-emerald-600 hover:bg-emerald-500 text-white":"bg-amber-600 hover:bg-amber-500 text-white"}`,children:u?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"w-5 h-5"}),"Resume"]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-5 h-5"}),"Pause"]})}),e.jsxs("button",{onClick:ie,className:"px-6 py-4 rounded-xl font-semibold bg-red-600 hover:bg-red-500 text-white flex items-center gap-2 transition-all",children:[e.jsx(pe,{className:"w-5 h-5"}),"Stop"]})]}):e.jsxs("button",{onClick:re,disabled:l.length===0,className:`flex-1 py-4 rounded-xl font-semibold text-lg flex items-center justify-center gap-3 transition-all ${l.length===0?"bg-slate-700 text-slate-400 cursor-not-allowed":"bg-gradient-to-r from-indigo-600 to-purple-600 text-white hover:from-indigo-500 hover:to-purple-500 shadow-lg shadow-indigo-500/25"}`,children:[e.jsx(me,{className:"w-5 h-5"}),"Start Scanning"," ",l.length>0&&`(${l.length} addresses)`]})}),f.length>0&&e.jsxs("div",{className:"bg-slate-800/50 rounded-xl border border-slate-700 overflow-hidden",children:[e.jsxs("button",{onClick:()=>ee(!P),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-slate-700/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-medium text-white",children:"Scan Progress"}),e.jsxs("span",{className:"text-sm text-slate-400",children:[E," success, ",oe," errors"]})]}),P?e.jsx($,{className:"w-5 h-5 text-slate-400"}):e.jsx(L,{className:"w-5 h-5 text-slate-400"})]}),P&&e.jsxs("div",{className:"px-6 pb-4",children:[e.jsx("div",{className:"h-2 bg-slate-900 rounded-full overflow-hidden mb-4",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-300",style:{width:`${xe}%`}})}),e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-1",children:f.slice(-50).map(s=>e.jsxs("div",{className:"flex items-center gap-3 py-1.5 text-sm",children:[s.status==="loading"&&e.jsx(X,{className:"w-4 h-4 text-indigo-400 animate-spin"}),s.status==="success"&&e.jsx(z,{className:"w-4 h-4 text-emerald-400"}),s.status==="error"&&e.jsx(G,{className:"w-4 h-4 text-red-400"}),e.jsx("span",{className:"font-mono text-slate-300 truncate flex-1",children:s.address}),s.status==="success"&&e.jsxs("span",{className:"text-slate-500",children:[s.transactions.length," tx"]}),s.status==="error"&&e.jsx("span",{className:"text-red-400 text-xs",children:s.error})]},s.address))})]})]}),i.length>0&&e.jsxs("div",{className:"bg-slate-800/50 rounded-xl border border-slate-700 overflow-hidden",children:[e.jsxs("button",{onClick:()=>se(!T),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-slate-700/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-medium text-white",children:"ðŸŽ¯ Layer 2 Destinations"}),e.jsxs("span",{className:"text-sm text-emerald-400",children:[i.length," wallets found"]})]}),T?e.jsx($,{className:"w-5 h-5 text-slate-400"}):e.jsx(L,{className:"w-5 h-5 text-slate-400"})]}),T&&e.jsxs("div",{className:"px-6 pb-4",children:[e.jsx("div",{className:"flex justify-end mb-3",children:e.jsxs("button",{onClick:()=>Se(i,"layer2_destinations.csv"),className:"px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-slate-300 text-sm rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx(be,{className:"w-4 h-4"}),"Export CSV"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-slate-400 border-b border-slate-700",children:[e.jsx("th",{className:"pb-2 pr-4",children:"#"}),e.jsx("th",{className:"pb-2 pr-4",children:"Address"}),e.jsx("th",{className:"pb-2 pr-4 text-right",children:"Total Received"}),e.jsx("th",{className:"pb-2 pr-4 text-right",children:"TX Count"}),e.jsx("th",{className:"pb-2 text-right",children:"Sources"})]})}),e.jsx("tbody",{children:i.slice(0,20).map((s,a)=>e.jsxs("tr",{className:"border-b border-slate-800 hover:bg-slate-700/30",children:[e.jsx("td",{className:"py-2 pr-4 text-slate-500",children:a+1}),e.jsx("td",{className:"py-2 pr-4",children:e.jsxs("a",{href:`${H[h].explorerUrl}/address/${s.address}`,target:"_blank",rel:"noopener noreferrer",className:"font-mono text-indigo-400 hover:text-indigo-300 flex items-center gap-1",children:[s.address.slice(0,10),"...",s.address.slice(-8),e.jsx(W,{className:"w-3 h-3"})]})}),e.jsxs("td",{className:"py-2 pr-4 text-right text-emerald-400 font-medium",children:[de(s.totalReceived)," USDT"]}),e.jsx("td",{className:"py-2 pr-4 text-right text-slate-300",children:s.incomingTxCount}),e.jsx("td",{className:"py-2 text-right text-slate-400",children:s.sourceAddresses.size})]},s.address))})]})}),i.length>20&&e.jsxs("p",{className:"text-center text-slate-500 mt-3 text-sm",children:["Showing top 20 of ",i.length," destinations"]})]})]}),j&&e.jsxs("div",{className:"bg-gradient-to-r from-emerald-900/30 to-indigo-900/30 rounded-xl p-6 border border-emerald-800/50",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"âœ… Scan Complete"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Addresses Scanned"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:j.successCount})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Total Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-indigo-400",children:j.allTransactions.length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Layer 2 Destinations"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:i.length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Errors"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:j.errorCount})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-xl border border-slate-700 overflow-hidden",children:[e.jsxs("button",{onClick:async()=>{if(te(!w),!w){const s=await S();y(s)}},className:"w-full px-6 py-4 flex items-center justify-between hover:bg-slate-700/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(fe,{className:"w-5 h-5 text-slate-400"}),e.jsx("span",{className:"font-medium text-white",children:"Cache Manager"}),c&&e.jsxs("span",{className:"text-sm text-slate-400",children:[c.totalEntries," entries (",c.totalSize,")"]})]}),w?e.jsx($,{className:"w-5 h-5 text-slate-400"}):e.jsx(L,{className:"w-5 h-5 text-slate-400"})]}),w&&e.jsxs("div",{className:"px-6 pb-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-900/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Use Cache"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Skip API calls for cached addresses"})]}),e.jsx("button",{onClick:()=>ae(!x),className:`relative w-12 h-6 rounded-full transition-colors ${x?"bg-indigo-600":"bg-slate-600"}`,children:e.jsx("div",{className:`absolute top-1 w-4 h-4 bg-white rounded-full transition-transform ${x?"left-7":"left-1"}`})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:I,onChange:s=>O(s.target.value),placeholder:"Enter address to clear cache...",className:"flex-1 px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white text-sm placeholder-slate-500 focus:border-indigo-500 outline-none font-mono"}),e.jsxs("button",{onClick:async()=>{if(I.trim()){const s=await ke(I.trim());O("");const a=await S();y(a),alert(`Cleared ${s} cache entries for this address`)}},className:"px-3 py-2 bg-orange-600 hover:bg-orange-500 text-white text-sm rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx(B,{className:"w-4 h-4"}),"Clear"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:async()=>{const s=await S();y(s)},className:"flex-1 px-3 py-2 bg-slate-700 hover:bg-slate-600 text-slate-300 text-sm rounded-lg flex items-center justify-center gap-2 transition-colors",children:[e.jsx(je,{className:"w-4 h-4"}),"Refresh Stats"]}),e.jsxs("button",{onClick:async()=>{if(confirm("Clear all cached data? This cannot be undone.")){await Ae();const s=await S();y(s)}},className:"flex-1 px-3 py-2 bg-red-600 hover:bg-red-500 text-white text-sm rounded-lg flex items-center justify-center gap-2 transition-colors",children:[e.jsx(B,{className:"w-4 h-4"}),"Clear All Cache"]})]}),c&&c.entries.length>0&&e.jsx("div",{className:"max-h-60 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-slate-400 border-b border-slate-700",children:[e.jsx("th",{className:"pb-2 pr-4",children:"Address"}),e.jsx("th",{className:"pb-2 pr-4",children:"Chain"}),e.jsx("th",{className:"pb-2 pr-4 text-right",children:"TX"}),e.jsx("th",{className:"pb-2 text-right",children:"Expires"})]})}),e.jsx("tbody",{children:c.entries.slice(0,20).map((s,a)=>e.jsxs("tr",{className:"border-b border-slate-800",children:[e.jsxs("td",{className:"py-2 pr-4 font-mono text-slate-300",children:[s.address.slice(0,10),"...",s.address.slice(-6)]}),e.jsx("td",{className:"py-2 pr-4 text-slate-400",children:s.chain.toUpperCase()}),e.jsx("td",{className:"py-2 pr-4 text-right text-indigo-400",children:s.txCount}),e.jsxs("td",{className:"py-2 text-right text-slate-500 text-xs",children:[Math.round((s.expiresAt.getTime()-Date.now())/6e4),"m left"]})]},a))})]})}),c&&c.entries.length===0&&e.jsx("p",{className:"text-center text-slate-500 py-4",children:"No cached data"})]})]})]})};export{Ie as W};
