import{r as g,j as e,U as j,S as v,l as w,m as S}from"../vendor-Cs9IRPBE.js";import{S as y}from"../index-KZY9J4_4.js";import{W as C}from"./walletscanner-m3Un0ADd.js";const D=i=>{const l=i.trim().split(`
`);if(l.length<2)return[];const d=l[0].toLowerCase().split(",").map(t=>t.trim()),r=t=>d.findIndex(m=>t.some(a=>m.includes(a))),n=r(["date","time","timestamp"]),u=r(["from","sender","source"]),o=r(["to","receiver","destination"]),c=r(["amount","value","qty"]),p=r(["currency","coin","symbol","asset"]),s=r(["hash","id","tx"]);if(n===-1||c===-1)throw new Error("CSV must contain at least Date and Amount columns.");return l.slice(1).map((t,m)=>{const a=t.split(",").map(N=>N.trim());if(a.length<d.length)return null;const x=a[n],h=a[c],f=new Date(x),b=parseFloat(h.replace(/[^0-9.-]/g,""));return isNaN(f.getTime())||isNaN(b)?null:{id:s!==-1?a[s]:`tx_${m}`,date:f,from:u!==-1?a[u]:"Unknown",to:o!==-1?a[o]:"Unknown",amount:Math.abs(b),currency:p!==-1?a[p]:"UNK",type:"transfer"}}).filter(t=>t!==null)},U=({onDataLoaded:i})=>{const[l,d]=g.useState("upload"),[r,n]=g.useState(null),[u,o]=g.useState(!1),c=s=>{const t=new FileReader;t.onload=m=>{var a;try{const x=(a=m.target)==null?void 0:a.result,h=D(x);if(h.length===0)throw new Error("No valid transactions found.");i(h),n(null)}catch(x){n(x.message)}},t.readAsText(s)},p=g.useCallback(s=>{s.preventDefault(),o(!1);const t=s.dataTransfer.files[0];t&&t.type==="text/csv"?c(t):n("Please upload a valid CSV file.")},[]);return e.jsxs("div",{className:"w-full max-w-4xl mx-auto mt-6 p-6",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsxs("div",{className:"inline-flex rounded-xl bg-slate-800/50 p-1 border border-slate-700",children:[e.jsxs("button",{onClick:()=>d("upload"),className:`flex items-center gap-2 px-6 py-3 rounded-lg text-sm font-medium transition-all ${l==="upload"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:[e.jsx(j,{className:"w-4 h-4"}),"Upload CSV"]}),e.jsxs("button",{onClick:()=>d("scan"),className:`flex items-center gap-2 px-6 py-3 rounded-lg text-sm font-medium transition-all ${l==="scan"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:[e.jsx(v,{className:"w-4 h-4"}),"Scan Wallets"]})]})}),l==="scan"?e.jsx(C,{onDataLoaded:i}):e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("div",{className:`
              relative border-2 border-dashed rounded-2xl p-12 text-center transition-all duration-300
              ${u?"border-indigo-400 bg-indigo-900/20":"border-slate-700 hover:border-slate-500 bg-slate-800/50"}
            `,onDragOver:s=>{s.preventDefault(),o(!0)},onDragLeave:()=>o(!1),onDrop:p,children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"p-4 bg-slate-800 rounded-full ring-4 ring-slate-700/50",children:e.jsx(j,{className:"w-8 h-8 text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Upload Transaction History"}),e.jsx("p",{className:"text-slate-400 mt-2 text-sm",children:"Drag & drop your CSV file here, or click to browse"})]}),e.jsx("input",{type:"file",accept:".csv",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:s=>{var t;(t=s.target.files)!=null&&t[0]&&c(s.target.files[0])}})]})}),e.jsxs("div",{className:"mt-6 flex flex-col items-center gap-4",children:[e.jsx("div",{className:"text-sm text-slate-500 uppercase tracking-widest font-medium",children:"Or"}),e.jsxs("button",{onClick:()=>i(y),className:"flex items-center gap-2 px-6 py-2.5 bg-slate-800 hover:bg-slate-700 text-indigo-400 rounded-lg border border-slate-700 transition-colors font-medium text-sm",children:[e.jsx(w,{className:"w-4 h-4"}),"Load Sample Data"]})]}),r&&e.jsxs("div",{className:"mt-6 p-4 bg-red-900/20 border border-red-800/50 rounded-lg flex items-center gap-3 text-red-200",children:[e.jsx(S,{className:"w-5 h-5 shrink-0"}),e.jsx("span",{className:"text-sm",children:r})]}),e.jsxs("div",{className:"mt-8 p-4 bg-slate-900/50 rounded-lg border border-slate-800 text-left",children:[e.jsx("h4",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:"Expected CSV Format"}),e.jsxs("code",{className:"block text-xs text-slate-400 font-mono p-2 bg-slate-950 rounded border border-slate-800",children:["Date, From, To, Amount, Currency",e.jsx("br",{}),"2023-10-01, 0xWalletA, 0xWalletB, 150.00, USDT"]})]})]})]})};export{U as default,D as parseCSV};
