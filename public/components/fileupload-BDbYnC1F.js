import{r as p,j as e,U as j,l as v,m as w}from"../vendor-u8cx4Mps.js";import{S as D}from"../index-DGMj3aU4.js";const y=m=>{const o=m.trim().split(`
`);if(o.length<2)return[];const i=o[0].toLowerCase().split(",").map(a=>a.trim()),l=a=>i.findIndex(n=>a.some(r=>n.includes(r))),c=l(["date","time","timestamp"]),d=l(["from","sender","source"]),x=l(["to","receiver","destination"]),t=l(["amount","value","qty"]),s=l(["currency","coin","symbol","asset"]),u=l(["hash","id","tx"]);if(c===-1||t===-1)throw new Error("CSV must contain at least Date and Amount columns.");return o.slice(1).map((a,n)=>{const r=a.split(",").map(N=>N.trim());if(r.length<i.length)return null;const h=r[c],b=r[t],f=new Date(h),g=parseFloat(b.replace(/[^0-9.-]/g,""));return isNaN(f.getTime())||isNaN(g)?null:{id:u!==-1?r[u]:`tx_${n}`,date:f,from:d!==-1?r[d]:"Unknown",to:x!==-1?r[x]:"Unknown",amount:Math.abs(g),currency:s!==-1?r[s]:"UNK",type:"transfer"}}).filter(a=>a!==null)},A=({onDataLoaded:m})=>{const[o,i]=p.useState(null),[l,c]=p.useState(!1),d=t=>{const s=new FileReader;s.onload=u=>{var a;try{const n=(a=u.target)==null?void 0:a.result,r=y(n);if(r.length===0)throw new Error("No valid transactions found.");m(r),i(null)}catch(n){i(n.message)}},s.readAsText(t)},x=p.useCallback(t=>{t.preventDefault(),c(!1);const s=t.dataTransfer.files[0];s&&s.type==="text/csv"?d(s):i("Please upload a valid CSV file.")},[]);return e.jsxs("div",{className:"w-full max-w-2xl mx-auto mt-10 p-6",children:[e.jsx("div",{className:`
          relative border-2 border-dashed rounded-2xl p-12 text-center transition-all duration-300
          ${l?"border-indigo-400 bg-indigo-900/20":"border-slate-700 hover:border-slate-500 bg-slate-800/50"}
        `,onDragOver:t=>{t.preventDefault(),c(!0)},onDragLeave:()=>c(!1),onDrop:x,children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"p-4 bg-slate-800 rounded-full ring-4 ring-slate-700/50",children:e.jsx(j,{className:"w-8 h-8 text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Upload Transaction History"}),e.jsx("p",{className:"text-slate-400 mt-2 text-sm",children:"Drag & drop your CSV file here, or click to browse"})]}),e.jsx("input",{type:"file",accept:".csv",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:t=>{var s;(s=t.target.files)!=null&&s[0]&&d(t.target.files[0])}})]})}),e.jsxs("div",{className:"mt-6 flex flex-col items-center gap-4",children:[e.jsx("div",{className:"text-sm text-slate-500 uppercase tracking-widest font-medium",children:"Or"}),e.jsxs("button",{onClick:()=>m(D),className:"flex items-center gap-2 px-6 py-2.5 bg-slate-800 hover:bg-slate-700 text-indigo-400 rounded-lg border border-slate-700 transition-colors font-medium text-sm",children:[e.jsx(v,{className:"w-4 h-4"}),"Load Sample Data"]})]}),o&&e.jsxs("div",{className:"mt-6 p-4 bg-red-900/20 border border-red-800/50 rounded-lg flex items-center gap-3 text-red-200",children:[e.jsx(w,{className:"w-5 h-5 shrink-0"}),e.jsx("span",{className:"text-sm",children:o})]}),e.jsxs("div",{className:"mt-8 p-4 bg-slate-900/50 rounded-lg border border-slate-800 text-left",children:[e.jsx("h4",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:"Expected CSV Format"}),e.jsxs("code",{className:"block text-xs text-slate-400 font-mono p-2 bg-slate-950 rounded border border-slate-800",children:["Date, From, To, Amount, Currency",e.jsx("br",{}),"2023-10-01, 0xWalletA, 0xWalletB, 150.00, USDT"]})]})]})};export{A as default,y as parseCSV};
