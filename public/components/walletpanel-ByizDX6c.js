import{r as i,j as e,aq as S,e as A,E as F,c as z,S as G,z as Q,P as q,h as K,i as X,k as _}from"../vendor-Cs9IRPBE.js";import{a as I,l as B}from"../index-KZY9J4_4.js";const m=56,Y=({selectedWallet:c,wallet:j,transactions:g,onClose:M,onRemoveWallet:v,onAddWallet:L,existingWalletSet:R,selectedWalletLane:$})=>{const[n,y]=i.useState("inflows"),[u,D]=i.useState(""),[E,C]=i.useState(0),[x,H]=i.useState("amount"),[b,T]=i.useState("desc"),k=i.useRef(null),d=i.useMemo(()=>{const t=g.filter(s=>s.to===c),o=g.filter(s=>s.from===c),r=new Map;return t.forEach(s=>{const a=r.get(s.from)||{address:s.from,inflow:0,outflow:0,count:0,lastTx:s.date};a.inflow+=s.amount,a.count++,s.date>a.lastTx&&(a.lastTx=s.date),r.set(s.from,a)}),o.forEach(s=>{const a=r.get(s.to)||{address:s.to,inflow:0,outflow:0,count:0,lastTx:s.date};a.outflow+=s.amount,a.count++,s.date>a.lastTx&&(a.lastTx=s.date),r.set(s.to,a)}),{wallet:j,inflows:t,outflows:o,counterparties:Array.from(r.values()),totalInflow:t.reduce((s,a)=>s+a.amount,0),totalOutflow:o.reduce((s,a)=>s+a.amount,0)}},[c,j,g]),f=i.useMemo(()=>{if(!d)return[];let t=d.counterparties;return n==="inflows"?t=t.filter(o=>o.inflow>0):t=t.filter(o=>o.outflow>0),u&&(t=t.filter(o=>o.address.toLowerCase().includes(u.toLowerCase()))),t.sort((o,r)=>{let s=0;switch(x){case"address":s=o.address.localeCompare(r.address);break;case"amount":const a=n==="inflows"?o.inflow:o.outflow,p=n==="inflows"?r.inflow:r.outflow;s=a-p;break;case"count":s=o.count-r.count;break;case"time":s=o.lastTx.getTime()-r.lastTx.getTime();break}return b==="desc"?-s:s})},[d,n,u,x,b]),h=i.useCallback(t=>{x===t?T(o=>o==="asc"?"desc":"asc"):(H(t),T("desc")),C(0)},[x]),w=({column:t})=>x!==t?e.jsx(K,{className:"w-3 h-3 opacity-40"}):b==="desc"?e.jsx(X,{className:"w-3 h-3"}):e.jsx(_,{className:"w-3 h-3"});return j?e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-xl flex flex-col overflow-hidden shrink-0 h-full max-h-[calc(100vh-100px)]",children:[e.jsxs("div",{className:"p-4 border-b border-slate-800 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-600 rounded-lg flex items-center justify-center shrink-0",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:c.slice(0,2).toUpperCase()})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-white font-semibold truncate copyable","data-copy":c,children:I(c)}),e.jsxs("div",{className:"flex items-center gap-3 text-xs mt-0.5",children:[e.jsxs("span",{className:"text-emerald-400 flex items-center gap-1",children:[e.jsx(S,{className:"w-3 h-3"}),"$",d.totalInflow.toLocaleString()]}),e.jsxs("span",{className:"text-orange-400 flex items-center gap-1",children:[e.jsx(A,{className:"w-3 h-3"}),"$",d.totalOutflow.toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>v(c),className:"p-2 hover:bg-red-500/20 rounded-lg transition-colors",title:"Remove from graph",children:e.jsx(F,{className:"w-4 h-4 text-red-400"})}),e.jsx("button",{onClick:M,className:"p-2 hover:bg-slate-800 rounded-lg transition-colors",title:"Close panel",children:e.jsx(z,{className:"w-4 h-4 text-slate-400"})})]})]}),e.jsxs("div",{className:"flex border-b border-slate-800",children:[e.jsxs("button",{onClick:()=>y("inflows"),className:`flex-1 py-2.5 text-sm font-medium flex items-center justify-center gap-2 transition-colors ${n==="inflows"?"text-emerald-400 border-b-2 border-emerald-400 bg-emerald-400/5":"text-slate-400 hover:text-slate-200"}`,children:[e.jsx(S,{className:"w-4 h-4"}),"Inflows (",d.inflows.length,")"]}),e.jsxs("button",{onClick:()=>y("outflows"),className:`flex-1 py-2.5 text-sm font-medium flex items-center justify-center gap-2 transition-colors ${n==="outflows"?"text-orange-400 border-b-2 border-orange-400 bg-orange-400/5":"text-slate-400 hover:text-slate-200"}`,children:[e.jsx(A,{className:"w-4 h-4"}),"Outflows (",d.outflows.length,")"]})]}),e.jsx("div",{className:"p-2 border-b border-slate-800",children:e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500"}),e.jsx("input",{type:"text",placeholder:"Search address...",value:u,onChange:t=>D(t.target.value),className:"w-full bg-slate-950 border border-slate-700 rounded-lg pl-9 pr-3 py-2 text-sm text-white focus:outline-none focus:border-indigo-500"})]})}),e.jsxs("div",{ref:k,className:"flex-1 overflow-auto",onScroll:t=>C(t.target.scrollTop),children:[e.jsx("div",{className:"sticky top-0 bg-slate-900 border-b border-slate-800 z-10",children:e.jsxs("div",{className:"flex text-xs text-slate-400 uppercase",children:[e.jsxs("button",{onClick:()=>h("address"),className:"flex-1 p-2 font-medium flex items-center gap-1 hover:text-slate-200 transition-colors text-left",children:["Address ",e.jsx(w,{column:"address"})]}),e.jsxs("button",{onClick:()=>h("amount"),className:"w-20 p-2 font-medium flex items-center justify-end gap-1 hover:text-slate-200 transition-colors",children:["Amount ",e.jsx(w,{column:"amount"})]}),e.jsxs("button",{onClick:()=>h("count"),className:"w-12 p-2 font-medium flex items-center justify-end gap-1 hover:text-slate-200 transition-colors",children:["Tx ",e.jsx(w,{column:"count"})]}),e.jsxs("button",{onClick:()=>h("time"),className:"w-20 p-2 font-medium flex items-center justify-end gap-1 hover:text-slate-200 transition-colors",children:["Last ",e.jsx(w,{column:"time"})]}),e.jsx("div",{className:"w-10 p-2"})]})}),e.jsx("div",{style:{height:f.length*m,position:"relative"},children:f.length===0?e.jsx("div",{className:"p-4 text-center text-slate-500 text-sm",children:"No counterparties found"}):(()=>{var p;const t=((p=k.current)==null?void 0:p.clientHeight)||400,o=3,r=Math.max(0,Math.floor(E/m)-o),s=Math.ceil(t/m)+o*2,a=Math.min(f.length,r+s);return f.slice(r,a).map((l,O)=>{const N=n==="inflows"?l.inflow:l.outflow,P=R.has(l.address),U=r+O;return e.jsxs("div",{className:"flex items-center hover:bg-slate-800/50 transition-colors border-b border-slate-800/50",style:{position:"absolute",top:U*m,left:0,right:0,height:m},children:[e.jsx("div",{className:"flex-1 p-2 truncate",children:e.jsx("span",{className:"text-sm text-slate-200 font-mono copyable","data-copy":l.address,children:I(l.address)})}),e.jsx("div",{className:"w-20 p-2 text-right",children:e.jsxs("span",{className:`text-sm font-medium ${n==="inflows"?"text-emerald-400":"text-orange-400"}`,children:["$",N>=1e3?`${(N/1e3).toFixed(1)}K`:N.toLocaleString()]})}),e.jsx("div",{className:"w-12 p-2 text-right",children:e.jsx("span",{className:"text-xs text-slate-400",children:l.count})}),e.jsx("div",{className:"w-20 p-2 text-right",children:e.jsx("span",{className:"text-xs text-slate-500",children:B(l.lastTx)})}),e.jsx("div",{className:"w-10 p-2 text-center",children:P?e.jsx("button",{onClick:()=>v(l.address),className:"p-1 rounded text-red-400 hover:bg-red-500/20 transition-colors",title:"Remove from graph",children:e.jsx(Q,{className:"w-4 h-4"})}):e.jsx("button",{onClick:()=>L(l.address,$,n==="inflows"),className:"p-1 rounded text-indigo-400 hover:bg-indigo-500/20 transition-colors",title:"Add to graph",children:e.jsx(q,{className:"w-4 h-4"})})})]},l.address)})})()})]})]}):null};export{Y as default};
