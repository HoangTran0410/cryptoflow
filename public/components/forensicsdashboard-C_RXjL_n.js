const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./transactiontable-CTzeOAME.js","../vendor-u8cx4Mps.js","../index-DGMj3aU4.js","../index-Bs_JqdHU.css","./loadingspinner-BBxdUFzY.js","./severitybadge-Ed3Ex3gV.js","./exportbutton-CztkarSI.js"])))=>i.map(i=>d[i]);
import{u as M,g as p,p as n,a as _,e as v,_ as b,L as g}from"../index-DGMj3aU4.js";import{r as l,j as e,n as j,S as k,o as O,p as A,N as S,c as E,q as T}from"../vendor-u8cx4Mps.js";const R=j(()=>b(()=>import("./transactiontable-CTzeOAME.js"),__vite__mapDeps([0,1,2,3]),import.meta.url),{fallback:g}),$=j(()=>b(()=>import("./loadingspinner-BBxdUFzY.js"),__vite__mapDeps([4,1,2,3]),import.meta.url),{fallback:g}),D=j(()=>b(()=>import("./severitybadge-Ed3Ex3gV.js"),__vite__mapDeps([5,1,2,3]),import.meta.url),{fallback:g}),H=j(()=>b(()=>import("./exportbutton-CztkarSI.js"),__vite__mapDeps([6,1,2,3]),import.meta.url),{fallback:g}),W=({transactions:r})=>{const{executeTask:u,isReady:w}=M(),[x,L]=l.useState([]),[m,P]=l.useState([]),[I,y]=l.useState(!0),[z,d]=l.useState(0),[V,h]=l.useState("Initializing..."),[t,f]=l.useState(null),[a,C]=l.useState(null),N=l.useCallback(async()=>{if(!w)return;y(!0),d(10),h("Initializing forensic engine...");const s=p("patterns",{txCount:r.length}),i=p("clusters",{txCount:r.length});let o=n.get(s),c=n.get(i);o||(d(30),h("Detecting suspicious patterns..."),o=await u({type:"DETECT_PATTERNS",payload:{transactions:r}}),o&&n.set(s,o)),c||(d(60),h("Clustering addresses & analyzing behaviors..."),c=await u({type:"CLUSTER_ADDRESSES",payload:{transactions:r}}),c&&n.set(i,c)),d(90),h("Finalizing analysis..."),L(o||[]),P(c||[]),setTimeout(()=>{d(100),y(!1)},500)},[r,w,u]);l.useEffect(()=>{N()},[N]);const F=()=>{const s=p("patterns",{txCount:r.length}),i=p("clusters",{txCount:r.length});n.delete(s),n.delete(i),N()},B=s=>{s==="json"?v({patterns:x,clusters:m},"json"):v(x,"patterns")},K={low:"from-green-500 to-emerald-500",medium:"from-yellow-500 to-orange-500",high:"from-orange-500 to-red-500",critical:"from-red-500 to-rose-600"};return I?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx($,{message:V,progress:z})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-red-500 to-orange-600 rounded-lg flex items-center justify-center shadow-lg shadow-red-500/20",children:e.jsx(k,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Forensics Suite"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Advanced pattern detection and analysis"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:F,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg text-sm font-medium transition-colors",title:"Re-run Analysis",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Rerun"})]}),e.jsx(H,{onExport:B,formats:["csv","json"],label:"Export Report"})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-orange-400"}),"Suspicious Activity Detected"]}),x.length===0?e.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 rounded-xl p-8 text-center",children:[e.jsx(k,{className:"w-12 h-12 text-green-500 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-300",children:"No suspicious patterns detected"}),e.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"All transactions appear normal"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map((s,i)=>e.jsxs("button",{onClick:()=>f(s),className:"bg-slate-900/50 border border-slate-800 hover:border-slate-700 rounded-xl p-5 text-left transition-all hover:shadow-lg hover:shadow-indigo-500/10 group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:`w-12 h-12 bg-gradient-to-br ${K[s.severity]} rounded-lg flex items-center justify-center shadow-lg opacity-80 group-hover:opacity-100 transition-opacity`,children:e.jsx(A,{className:"w-6 h-6 text-white"})}),e.jsx(D,{severity:s.severity,score:Math.round(s.score),size:"sm"})]}),e.jsx("h4",{className:"text-white font-semibold mb-1 capitalize",children:s.type.replace(/_/g," ")}),e.jsx("p",{className:"text-slate-400 text-xs mb-3 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-slate-500",children:[s.affectedAddresses.length," addresses"]}),e.jsxs("span",{className:"text-slate-500",children:[s.transactions.length," txs"]})]})]},i))})]}),m.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-indigo-400"}),"Address Clusters (",m.length,")"]}),e.jsx("div",{className:"bg-slate-900/50 border border-slate-800 rounded-xl overflow-hidden",children:e.jsx("div",{className:"max-h-96 overflow-y-auto",children:m.slice(0,10).map((s,i)=>e.jsxs("button",{onClick:()=>C(s),className:"w-full text-left border-b border-slate-800 last:border-b-0 p-4 hover:bg-slate-800/30 transition-colors group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-indigo-400 font-mono text-sm font-semibold group-hover:text-indigo-300 transition-colors",children:s.clusterId}),e.jsx("p",{className:"text-slate-400 text-xs mt-1",children:s.commonBehavior})]}),e.jsxs("span",{className:"text-slate-500 text-xs",children:["Confidence: ",(s.confidenceScore*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[e.jsxs("span",{className:"text-slate-400",children:[e.jsx("span",{className:"text-white font-semibold",children:s.addresses.length})," ","addresses"]}),e.jsxs("span",{className:"text-slate-400",children:[e.jsx("span",{className:"text-white font-semibold",children:s.transactionCount})," ","txs"]}),e.jsxs("span",{className:"text-slate-400",children:["Volume:"," ",e.jsx("span",{className:"text-white font-semibold",children:s.totalVolume.toLocaleString()})]})]})]},s.clusterId))})})]}),t&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-2xl max-w-4xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-slate-800 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white capitalize mb-2",children:t.type.replace(/_/g," ")}),e.jsx(D,{severity:t.severity,score:Math.round(t.score)})]}),e.jsx("button",{onClick:()=>f(null),className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(E,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[e.jsx("p",{className:"text-slate-300 mb-6",children:t.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4",children:[e.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Affected Addresses"}),e.jsx("p",{className:"text-white text-2xl font-bold",children:t.affectedAddresses.length})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4",children:[e.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Transactions"}),e.jsx("p",{className:"text-white text-2xl font-bold",children:t.transactions.length})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-white font-semibold mb-3",children:"Affected Addresses"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.affectedAddresses.map(s=>e.jsx("span",{"data-copy":s,className:"px-2 py-1 bg-slate-800 text-slate-300 rounded text-xs font-mono border border-slate-700 copyable",children:_(s)},s))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-slate-400"}),"Pattern Transactions"]}),e.jsx("div",{className:"bg-slate-900 border border-slate-800 rounded-xl overflow-hidden h-[450px]",children:e.jsx(R,{showHeader:!1,transactions:t.transactions})})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-800 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>f(null),className:"px-4 py-2 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-sm transition-colors",children:"Close"}),e.jsx("button",{onClick:()=>{v([t],"patterns",`pattern-${t.type}.csv`)},className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-sm transition-colors",children:"Export Pattern Data"})]})]})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-2xl max-w-5xl w-full max-h-[85vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-slate-800 flex items-start justify-between bg-slate-900/50",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(S,{className:"w-6 h-6 text-indigo-400"}),e.jsx("h3",{className:"text-xl font-bold text-white",children:"Cluster Details"})]}),e.jsx("p",{className:"text-slate-400 text-sm font-mono",children:a.clusterId})]}),e.jsx("button",{onClick:()=>C(null),className:"text-slate-400 hover:text-white transition-colors p-1 hover:bg-slate-800 rounded-lg",children:e.jsx(E,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-slate-700/50",children:[e.jsx("p",{className:"text-slate-500 text-xs mb-1 uppercase tracking-wider",children:"Confidence"}),e.jsxs("p",{className:"text-indigo-400 text-2xl font-bold",children:[(a.confidenceScore*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-slate-700/50",children:[e.jsx("p",{className:"text-slate-500 text-xs mb-1 uppercase tracking-wider",children:"Addresses"}),e.jsx("p",{className:"text-white text-2xl font-bold",children:a.addresses.length})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-slate-700/50",children:[e.jsx("p",{className:"text-slate-500 text-xs mb-1 uppercase tracking-wider",children:"Total Volume"}),e.jsx("p",{className:"text-white text-2xl font-bold",children:a.totalVolume.toLocaleString()})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-slate-700/50",children:[e.jsx("p",{className:"text-slate-500 text-xs mb-1 uppercase tracking-wider",children:"Transactions"}),e.jsx("p",{className:"text-white text-2xl font-bold",children:a.transactionCount})]})]}),e.jsxs("div",{className:"bg-indigo-900/20 border border-indigo-500/20 rounded-xl p-4",children:[e.jsx("h4",{className:"text-indigo-300 font-semibold mb-2 text-sm",children:"Detected Behavior"}),e.jsx("p",{className:"text-indigo-100/80 text-sm",children:a.commonBehavior})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold mb-3 text-sm",children:"Clustered Addresses"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.addresses.map(s=>e.jsx("span",{className:"px-2 py-1 bg-slate-800 text-slate-300 rounded text-xs font-mono border border-slate-700 copyable","data-copy":s,children:_(s)},s))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-slate-400"}),"Cluster Transactions"]}),e.jsx("div",{className:"bg-slate-900 border border-slate-800 rounded-xl overflow-hidden h-[450px]",children:e.jsx(R,{showHeader:!1,transactions:r.filter(s=>a.addresses.includes(s.from)||a.addresses.includes(s.to))})})]})]})]})})]})};export{W as default};
